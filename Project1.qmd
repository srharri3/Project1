```{r}
library(tidyr)
library(dplyr)
```

Making tibble have additional class of "census".
```{r}
class(census_tibble) <- c("census", class(census_tibble))
```

```{r}
summary.census <- function(census_tibble, num_vars = NULL, cat_vars = NULL) {
  num_summary <-
  census_tibble |>
    summarize(across(where(is.numeric != "PWGTP"),
                     list("mean" = ~sum(var*weight_vector)/sum(weight_vector),
                          "sd" = ~sqrt(sum(var^2*weight_vector)/sum(weight_vector)-sample_mean^2))))
  
  cat_count <-
  census_tibble |>
  group_by(!!sym(var)) |>
  summarize(count = n())
}

result <- list(numeric_summary = num_summary, catagorical_count = cat_count)
```

```{r}
summary(census_tibble)
```

```{r}
library(ggplot2)
```

```{r}
plot.census <- function(census_tibble, num_var, cat_var) {
  ggplot(data = _your_census_tibble_or_modification_,
aes(x = get(cat_var), y = get(num_var), weight = PWGTP)) + geom_boxplot()
}
```

